{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Weapon Store 2026{% endblock %}</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <script src="{% static 'js/main.js' %}"></script>
</head>
<body class="page">
    <div id="menu-overlay" class="overlay"></div>
    <div id="toast-container"></div>
    {% if messages %}
        <script>
            document.addEventListener('DOMContentLoaded', () => {
                const triggerMessages = () => {
                    if (typeof window.createToast === 'function') {
                        {% for message in messages %}
                            window.createToast("{{ message|escapejs }}", "{{ message.tags }}");
                        {% endfor %}
                    } else {
                        setTimeout(triggerMessages, 50);
                    }
                };
                triggerMessages();
            });
        </script>
    {% endif %}
    <div class="main-wrapper">
        <header>
            <h1><a href="{% url 'item_list' %}">Weapon Store</a></h1>
            <hr>
        </header>
        <button class="burger-menu" id="burger-toggle">
            <span></span>
            <span></span>
            <span></span>
        </button>
        <aside id="sidebar">
            <nav>
                <h3>–ü—Ä–æ—Ñ–∏–ª—å</h3>
                    <ul class="account-menu">
                        {% if request.user.is_authenticated %}
                            <li>
                                <a href="{% url 'user_profile' %}" class="profile_link">
                                    üë§ {{ request.user.username }}
                                </a>
                            </li>
                            <li>{% if request.user.is_authenticated %}
                                <form action="{% url 'logout' %}" method="post" style="display: inline;">
                                    {% csrf_token %}
                                    <a href="#" onclick="this.closest('form').submit(); return false;" style="opacity: 0.6;">
                                        –í—ã–π—Ç–∏ ({{ request.user.username }})
                                    </a>
                                </form>
                                {% else %}
                                    <a href="{% url 'login' %}" style="opacity: 0.6;">–í–æ–π—Ç–∏</a>
                                {% endif %}
                            </li>
                        {% else %}
                            <li><a href="{% url 'login' %}">–í–æ–π—Ç–∏</a></li>
                            <li><a href="{% url 'register' %}">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a></li>
                        {% endif %}
                    </ul>
                <div class="search-box">
                    <hr>
                    <input type="text" id="live-search" class="live-search" placeholder="–ü–æ–∏—Å–∫ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤..." autocomplete="off">
                    <hr>
                </div>
                <h3>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</h3>
                <ul class="category-container">
                    <li>
                        <a href="{% url 'item_list' %}">–í—Å–µ —Ç–æ–≤–∞—Ä—ã</a>
                    </li>
                    {% for category in categories %}
                        <li>
                            <a href="{% url 'item_list_by_category' category.slug %}">{{ category.name }}</a>
                        </li>
                    {% endfor %}
                </ul>
                <a href="{% url 'cart_detail' %}" class="cart-link">üõí –ö–æ—Ä–∑–∏–Ω–∞ (<span id="cart-count">{{ total_quantity }}</span>)</a>
            </nav>
            <div class="info-section">
                <div>–≥. –ú–æ–Ω–¥—à–∞—Ç, —É–ª. –í–µ—Ç—Ä—è–Ω–Ω–∞—è, –¥.7</div>
                <div class="info-contacts">
                    <p>+7 (171) 717 17 71 / bezlepkin_artur@mail.ru</p>
                </div>
                <div class="info-links">
                    <a href="#" target="_blank"><img src="{% static 'images/icons/free-icon-vk.png' %}" alt="VK"></a>
                    <a href="#" target="_blank"><img src="{% static 'images/icons/free-icon-telegram.png' %}" alt="Telegram"></a>
                    <a href="#" target="_blank"><img src="{% static 'images/icons/free-icon-twitch.png' %}" alt="VK"></a>
                </div>
                <a class="idea-source" href="https://www.flaticon.com/ru/free-icons/social-networks">–û–±–ª–æ–∂–∫–∏ —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–µ—Ç–µ–π –±—ã–ª–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ä–µ—Å—É—Ä—Å–æ–≤ —Å–∞–π—Ç–∞ Flaticon.com.</a>
            </div>
        </aside>

        <main>
            {% block content %}
            <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –¥—Ä—É–≥–∏—Ö —à–∞–±–ª–æ–Ω–æ–≤ -->
            {% endblock %}
        </main>
    </div>
    <footer>
        <hr>
        <div class="footer-blocks">
            <div>
                <p>–≥. –ú–æ–Ω–¥—à–∞—Ç, —É–ª. –í–µ—Ç—Ä—è–Ω–Ω–∞—è, –¥.7</p>
                <p class="info-contacts">+7 (171) 717 17 71 / bezlepkin_artur@mail.ru</p>
                <div class="info-links">
                    <a href="#" target="_blank"><img src="{% static 'images/icons/free-icon-vk.png' %}" alt="VK"></a>
                    <a href="#" target="_blank"><img src="{% static 'images/icons/free-icon-telegram.png' %}" alt="Telegram"></a>
                    <a href="#" target="_blank"><img src="{% static 'images/icons/free-icon-twitch.png' %}" alt="VK"></a>
                </div>
            </div>
            <div class="source-container">
                <a class="idea-source" href="https://www.flaticon.com/ru/free-icons/social-networks">–û–±–ª–æ–∂–∫–∏ —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–µ—Ç–µ–π –±—ã–ª–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ä–µ—Å—É—Ä—Å–æ–≤ —Å–∞–π—Ç–∞ Flaticon.com.</a>
                <p style="margin-bottom: 4px;"></p>
                <a class="idea-source" href="https://genshin.hoyoverse.com/ru">–ò–¥–µ–π–Ω–∞—è –∫–æ–Ω—Ü–µ–ø—Ü–∏—è –º–∞–≥–∞–∑–∏–Ω–∞, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤ –∏ –∏—Ö –æ–ø–∏—Å–∞–Ω–∏—è –±—ã–ª–∏ –≤–∑—è—Ç—ã –∏–∑ –∏–≥—Ä—ã ¬´Genshin Impact¬ª</a>
                <p style="margin-bottom: 4px;"></p>
                <p>Copyright ¬© Weapon-Store, 2025‚Äî2026. –ù–µ —è–≤–ª—è–µ—Ç—Å—è –∞—Ñ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∏ –Ω–µ —Å–≤—è–∑–∞–Ω —Å –∫–æ–º–ø–∞–Ω–∏–µ–π miHoYo. –ê–≤—Ç–æ—Ä —Å–∞–π—Ç–∞ - –ë–µ–∑–ª–µ–ø–∫–∏–Ω –ê—Ä—Ç—É—Ä –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–∏—á.</p>
            </div>
        </div>
    </footer>
    <div id="snake-container" class="snake-layer"></div>
    <script src="{% static 'js/snake.js' %}"></script>
    <script src="{% static 'js/animations.js' %}"></script>
</body>
</html>